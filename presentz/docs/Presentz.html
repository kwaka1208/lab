<!DOCTYPE html>  <html> <head>   <title>Presentz.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="BlipTv.html">                 BlipTv.coffee               </a>                                           <a class="source" href="Html5Video.html">                 Html5Video.coffee               </a>                                           <a class="source" href="IFrameSlide.html">                 IFrameSlide.coffee               </a>                                           <a class="source" href="ImgSlide.html">                 ImgSlide.coffee               </a>                                           <a class="source" href="NoSlide.html">                 NoSlide.coffee               </a>                                           <a class="source" href="Presentz.html">                 Presentz.coffee               </a>                                           <a class="source" href="RvlIO.html">                 RvlIO.coffee               </a>                                           <a class="source" href="SlideShare.html">                 SlideShare.coffee               </a>                                           <a class="source" href="SlideShareOEmbed.html">                 SlideShareOEmbed.coffee               </a>                                           <a class="source" href="SpeakerDeck.html">                 SpeakerDeck.coffee               </a>                                           <a class="source" href="SwfSlide.html">                 SwfSlide.coffee               </a>                                           <a class="source" href="Video.html">                 Video.coffee               </a>                                           <a class="source" href="Vimeo.html">                 Vimeo.coffee               </a>                                           <a class="source" href="Youtube.html">                 Youtube.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               Presentz.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>Presentz is the main (and, hopefully, only) class whose API you need to know</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Presentz</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Used as default callback function</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">EMPTY_FUNCTION = </span><span class="nf">() -&gt;</span>

  <span class="nv">toWidthHeight = </span><span class="nf">(str) -&gt;</span>
    <span class="nv">parts = </span><span class="nx">str</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="nv">widthHeight =</span>
      <span class="nv">width: </span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="nv">height: </span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Builds a new presentz instance                                    </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">constructor: </span><span class="nf">(videoContainer, videoWxH, slideContainer, slideWxH) -&gt;</span>
    <span class="nv">sizeOfVideo = </span><span class="nx">toWidthHeight</span><span class="p">(</span><span class="nx">videoWxH</span><span class="p">)</span>
    <span class="nv">sizeOfSlide = </span><span class="nx">toWidthHeight</span><span class="p">(</span><span class="nx">slideWxH</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Creates new instances of each built-in plugin and put them in the availableVideoPlugins and availableSlidePlugins instance variables</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@availableVideoPlugins =</span>
      <span class="nv">vimeo: </span><span class="k">new</span> <span class="nx">Vimeo</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">videoContainer</span><span class="p">,</span> <span class="nx">sizeOfVideo</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfVideo</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">youtube: </span><span class="k">new</span> <span class="nx">Youtube</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">videoContainer</span><span class="p">,</span> <span class="nx">sizeOfVideo</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfVideo</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">html5: </span><span class="k">new</span> <span class="nx">Html5Video</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">videoContainer</span><span class="p">,</span> <span class="nx">sizeOfVideo</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfVideo</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>

    <span class="vi">@availableSlidePlugins =</span>
      <span class="nv">slideshare: </span><span class="k">new</span> <span class="nx">SlideShare</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slideContainer</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">slideshareoembed: </span><span class="k">new</span> <span class="nx">SlideShareOEmbed</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slideContainer</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">swf: </span><span class="k">new</span> <span class="nx">SwfSlide</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slideContainer</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">speakerdeck: </span><span class="k">new</span> <span class="nx">SpeakerDeck</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slideContainer</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">image: </span><span class="k">new</span> <span class="nx">ImgSlide</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slideContainer</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">iframe: </span><span class="k">new</span> <span class="nx">IFrameSlide</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slideContainer</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">rvlio: </span><span class="k">new</span> <span class="nx">RvlIO</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slideContainer</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">sizeOfSlide</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span>
      <span class="nv">none: </span><span class="k">new</span> <span class="nx">NoSlide</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>When looking for a plugin able to handle a video/slide url, presentz consults the videoPlugins and slidePlugins instance variables: you can avoid such lookup by specifying the plugin to use</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@videoPlugins = </span><span class="p">[</span><span class="nx">@availableVideoPlugins</span><span class="p">.</span><span class="nx">vimeo</span><span class="p">,</span> <span class="nx">@availableVideoPlugins</span><span class="p">.</span><span class="nx">youtube</span><span class="p">]</span>
    <span class="vi">@slidePlugins = </span><span class="p">[</span><span class="nx">@availableSlidePlugins</span><span class="p">.</span><span class="nx">slideshare</span><span class="p">,</span> <span class="nx">@availableSlidePlugins</span><span class="p">.</span><span class="nx">slideshareoembed</span><span class="p">,</span> <span class="nx">@availableSlidePlugins</span><span class="p">.</span><span class="nx">swf</span><span class="p">,</span> <span class="nx">@availableSlidePlugins</span><span class="p">.</span><span class="nx">speakerdeck</span><span class="p">,</span> <span class="nx">@availableSlidePlugins</span><span class="p">.</span><span class="nx">rvlio</span><span class="p">,</span> <span class="nx">@availableSlidePlugins</span><span class="p">.</span><span class="nx">none</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>When no plugin seems able to handle given video/slide, default ones are used</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@defaultVideoPlugin = </span><span class="nx">@availableVideoPlugins</span><span class="p">.</span><span class="nx">html5</span>
    <span class="vi">@defaultSlidePlugin = </span><span class="nx">@availableSlidePlugins</span><span class="p">.</span><span class="nx">image</span>

    <span class="vi">@currentChapterIndex = </span><span class="o">-</span><span class="mi">1</span>
    <span class="vi">@currentSlideIndex = </span><span class="o">-</span><span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>List of listeners for each event type</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@listeners =</span>
      <span class="nv">slidechange: </span><span class="p">[]</span>
      <span class="nv">videochange: </span><span class="p">[]</span>
      <span class="nv">timechange: </span><span class="p">[]</span>
      <span class="nv">play: </span><span class="p">[]</span>
      <span class="nv">pause: </span><span class="p">[]</span>
      <span class="nv">finish: </span><span class="p">[]</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>There are times when you DON'T want your slides synchronized with the video</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="vi">@isSynchronized = </span><span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Before calling init(), if you have your own video plugin, register it</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">registerVideoPlugin: </span><span class="nf">(name, plugin) -&gt;</span>
    <span class="nx">@availableVideoPlugins</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">plugin</span>
    <span class="nx">@videoPlugins</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">plugin</span><span class="p">)</span>
    <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Before calling init(), if you have your own slide plugin, register it</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">registerSlidePlugin: </span><span class="nf">(name, plugin) -&gt;</span>
    <span class="nx">@availableSlidePlugins</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">plugin</span>
    <span class="nx">@slidePlugins</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">plugin</span><span class="p">)</span>
    <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Init presentz with the presentation to show: a _plugin field will be added to each video and slide object, holding a reference to the proper video/slide plugin</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">init: </span><span class="nf">(@presentation) -&gt;</span>
    <span class="nx">@stopTimeChecker</span><span class="p">()</span> <span class="k">if</span> <span class="nx">@intervalSet</span>

    <span class="vi">@currentChapterIndex = </span><span class="o">-</span><span class="mi">1</span>
    <span class="vi">@currentSlideIndex = </span><span class="o">-</span><span class="mi">1</span>

    <span class="k">for</span> <span class="nx">chapter</span> <span class="k">in</span> <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span>
      <span class="nv">chapter.video._plugin = </span><span class="nx">findVideoPlugin</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">chapter</span><span class="p">.</span><span class="nx">video</span><span class="p">)</span>
      <span class="k">for</span> <span class="nx">slide</span> <span class="k">in</span> <span class="nx">chapter</span><span class="p">.</span><span class="nx">slides</span>
        <span class="nv">slide._plugin = </span><span class="nx">findSlidePlugin</span><span class="p">(</span><span class="err">@</span><span class="p">,</span> <span class="nx">slide</span><span class="p">)</span>
      <span class="k">if</span> <span class="o">!</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">duration</span><span class="o">?</span> <span class="o">and</span> <span class="nx">chapter</span><span class="p">.</span><span class="nx">slides</span><span class="o">?</span> <span class="o">and</span> <span class="nx">chapter</span><span class="p">.</span><span class="nx">slides</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="nv">chapter.duration = </span><span class="nx">chapter</span><span class="p">.</span><span class="nx">slides</span><span class="p">[</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">slides</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">time</span> <span class="o">+</span> <span class="mi">5</span>

    <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Register a listener to an event of the given type</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kc">on</span><span class="o">:</span> <span class="nf">(eventType, callback) -&gt;</span>
    <span class="nx">@listeners</span><span class="p">[</span><span class="nx">eventType</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Changes chapter: each chapter has one video, so you can think of this function as "changeVideo"</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">changeChapter: </span><span class="nf">(chapterIndex, slideIndex, play, callback = EMPTY_FUNCTION) -&gt;</span>
    <span class="nv">targetChapter = </span><span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">chapterIndex</span><span class="p">]</span>
    <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="s2">&quot;no chapter at index #{chapterIndex}&quot;</span><span class="p">)</span> <span class="nx">unless</span> <span class="nx">targetChapter</span><span class="o">?</span>

    <span class="nv">targetSlide = </span><span class="nx">targetChapter</span><span class="p">.</span><span class="nx">slides</span><span class="p">[</span><span class="nx">slideIndex</span><span class="p">]</span>
    <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="s2">&quot;no slide at index #{slideIndex}&quot;</span><span class="p">)</span> <span class="nx">unless</span> <span class="nx">targetSlide</span><span class="o">?</span>

    <span class="k">if</span> <span class="nx">chapterIndex</span> <span class="o">isnt</span> <span class="nx">@currentChapterIndex</span> <span class="o">or</span> <span class="p">(</span><span class="nx">@currentChapterIndex</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span> <span class="o">and</span> <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span><span class="p">].</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">skipTo</span><span class="p">(</span><span class="nx">targetSlide</span><span class="p">.</span><span class="nx">time</span><span class="p">,</span> <span class="nx">play</span><span class="p">))</span>
      <span class="nx">@changeSlide</span><span class="p">(</span><span class="nx">chapterIndex</span><span class="p">,</span> <span class="nx">slideIndex</span><span class="p">)</span>
      <span class="k">if</span> <span class="nx">chapterIndex</span> <span class="o">isnt</span> <span class="nx">@currentChapterIndex</span>
        <span class="nx">targetChapter</span><span class="p">.</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">changeVideo</span><span class="p">(</span><span class="nx">targetChapter</span><span class="p">.</span><span class="nx">video</span><span class="p">,</span> <span class="nx">play</span><span class="p">)</span>
        <span class="nx">targetChapter</span><span class="p">.</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">skipTo</span><span class="p">(</span><span class="nx">targetSlide</span><span class="p">.</span><span class="nx">time</span><span class="p">,</span> <span class="nx">play</span><span class="p">)</span>
        <span class="k">for</span> <span class="nx">listener</span> <span class="k">in</span> <span class="nx">@listeners</span><span class="p">.</span><span class="nx">videochange</span>
          <span class="nx">listener</span><span class="p">(</span><span class="nx">@currentChapterIndex</span><span class="p">,</span> <span class="nx">@currentSlideIndex</span><span class="p">,</span> <span class="nx">chapterIndex</span><span class="p">,</span> <span class="nx">slideIndex</span><span class="p">)</span>
      <span class="vi">@currentChapterIndex = </span><span class="nx">chapterIndex</span>

    <span class="nx">callback</span><span class="p">()</span>
    <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Changes slide. it will also ask the next 4 slides to preload themselves</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">changeSlide: </span><span class="nf">(chapterIndex, slideIndex) -&gt;</span>
    <span class="nv">slide = </span><span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">chapterIndex</span><span class="p">].</span><span class="nx">slides</span><span class="p">[</span><span class="nx">slideIndex</span><span class="p">]</span>
    <span class="nx">slide</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">changeSlide</span><span class="p">(</span><span class="nx">slide</span><span class="p">)</span>

    <span class="nv">previousSlideIndex = </span><span class="nx">@currentSlideIndex</span>
    <span class="vi">@currentSlideIndex = </span><span class="nx">slideIndex</span>

    <span class="nv">next4Slides = </span><span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">chapterIndex</span><span class="p">].</span><span class="nx">slides</span><span class="p">[(</span><span class="nx">slideIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)..(</span><span class="nx">slideIndex</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)]</span>
    <span class="k">for</span> <span class="nx">nextSlide</span> <span class="k">in</span> <span class="nx">next4Slides</span>
      <span class="nx">nextSlide</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">preload</span><span class="p">(</span><span class="nx">nextSlide</span><span class="p">)</span> <span class="k">if</span> <span class="nx">nextSlide</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">preload</span><span class="o">?</span>

    <span class="k">for</span> <span class="nx">listener</span> <span class="k">in</span> <span class="nx">@listeners</span><span class="p">.</span><span class="nx">slidechange</span>
      <span class="nx">listener</span><span class="p">(</span><span class="nx">@currentChapterIndex</span><span class="p">,</span> <span class="nx">previousSlideIndex</span><span class="p">,</span> <span class="nx">chapterIndex</span><span class="p">,</span> <span class="nx">slideIndex</span><span class="p">)</span>

    <span class="k">return</span>
  </pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Checks if the currently displayed slide has to be changed</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">checkSlideChange: </span><span class="nf">(currentTime) -&gt;</span>
    <span class="nv">slides = </span><span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span><span class="p">].</span><span class="nx">slides</span>
    <span class="k">for</span> <span class="nx">slide</span> <span class="k">in</span> <span class="nx">slides</span> <span class="k">when</span> <span class="nx">slide</span><span class="p">.</span><span class="nx">time</span> <span class="o">&lt;=</span> <span class="nx">currentTime</span>
      <span class="nv">candidateSlide = </span><span class="nx">slide</span>

    <span class="k">if</span> <span class="nx">candidateSlide</span><span class="o">?</span> <span class="o">and</span> <span class="nx">slides</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">candidateSlide</span><span class="p">)</span> <span class="o">isnt</span> <span class="nx">@currentSlideIndex</span>
      <span class="nx">@changeSlide</span><span class="p">(</span><span class="nx">@currentChapterIndex</span><span class="p">,</span> <span class="nx">slides</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">candidateSlide</span><span class="p">))</span>

    <span class="k">for</span> <span class="nx">listener</span> <span class="k">in</span> <span class="nx">@listeners</span><span class="p">.</span><span class="nx">timechange</span>
      <span class="nx">listener</span><span class="p">(</span><span class="nx">currentTime</span><span class="p">)</span>

    <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Utility function that looks up a proper video plugin for the given video</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">findVideoPlugin = </span><span class="nf">(presentz, video) -&gt;</span>
    <span class="k">return</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">availableVideoPlugins</span><span class="p">[</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin_id</span><span class="p">]</span> <span class="k">if</span> <span class="nx">video</span><span class="p">.</span><span class="nx">_plugin_id</span><span class="o">?</span> <span class="o">and</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">availableVideoPlugins</span><span class="p">[</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin_id</span><span class="p">]</span><span class="o">?</span>

    <span class="nv">plugins = </span><span class="p">(</span><span class="nx">plugin</span> <span class="k">for</span> <span class="nx">plugin</span> <span class="k">in</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">videoPlugins</span> <span class="k">when</span> <span class="nx">plugin</span><span class="p">.</span><span class="nx">handle</span><span class="p">(</span><span class="nx">video</span><span class="p">))</span>
    <span class="k">return</span> <span class="nx">plugins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nx">plugins</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">defaultVideoPlugin</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Utility function that looks up a proper slide plugin for the given slide</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">findSlidePlugin = </span><span class="nf">(presentz, slide) -&gt;</span>
    <span class="k">return</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">availableSlidePlugins</span><span class="p">[</span><span class="nx">slide</span><span class="p">.</span><span class="nx">_plugin_id</span><span class="p">]</span> <span class="k">if</span> <span class="nx">slide</span><span class="p">.</span><span class="nx">_plugin_id</span><span class="o">?</span> <span class="o">and</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">availableSlidePlugins</span><span class="p">[</span><span class="nx">slide</span><span class="p">.</span><span class="nx">_plugin_id</span><span class="p">]</span><span class="o">?</span>

    <span class="nv">plugins = </span><span class="p">(</span><span class="nx">plugin</span> <span class="k">for</span> <span class="nx">plugin</span> <span class="k">in</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">slidePlugins</span> <span class="k">when</span> <span class="nx">plugin</span><span class="p">.</span><span class="nx">handle</span><span class="p">(</span><span class="nx">slide</span><span class="p">))</span>
    <span class="k">return</span> <span class="nx">plugins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nx">plugins</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nx">presentz</span><span class="p">.</span><span class="nx">defaultSlidePlugin</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Sets the synchronized state of presentz, that is: if the slides have to be in synch with the video or not</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">synchronized: </span><span class="nf">(@isSynchronized) -&gt;</span>
    <span class="nx">@stopTimeChecker</span><span class="p">()</span> <span class="k">if</span> <span class="nx">@intervalSet</span> <span class="o">and</span> <span class="o">!</span><span class="nx">@isSynchronized</span>
    <span class="nx">@startTimeChecker</span><span class="p">()</span> <span class="k">if</span> <span class="o">!</span><span class="nx">@intervalSet</span> <span class="o">and</span> <span class="nx">@isSynchronized</span> <span class="o">and</span> <span class="o">!</span><span class="nx">@isPaused</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Starts polling the current time to check if a slide change has to occur</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">startTimeChecker: </span><span class="nf">() -&gt;</span>
    <span class="k">return</span> <span class="nx">unless</span> <span class="nx">@isSynchronized</span>

    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">@interval</span><span class="p">)</span>
    <span class="vi">@intervalSet = </span><span class="kc">true</span>
    <span class="nv">timeChecker = </span><span class="p">()</span> <span class="o">=&gt;</span>
      <span class="nx">@checkSlideChange</span><span class="p">(</span><span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span><span class="p">].</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">currentTime</span><span class="p">())</span> <span class="k">if</span> <span class="nx">@currentChapterIndex</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span>
      <span class="k">return</span>
    <span class="vi">@interval = </span><span class="nx">setInterval</span><span class="p">(</span><span class="nx">timeChecker</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Stops polling the current time </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">stopTimeChecker: </span><span class="nf">() -&gt;</span>
    <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">@interval</span><span class="p">)</span>
    <span class="vi">@intervalSet = </span><span class="kc">false</span>
    <span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Utility function to create new DOM element IDs</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">newElementName: </span><span class="nf">(prefix) -&gt;</span>
    <span class="k">if</span> <span class="nx">prefix</span><span class="o">?</span>
      <span class="s2">&quot;#{prefix}_#{Math.round(Math.random() * 1000000)}&quot;</span>
    <span class="k">else</span>
      <span class="s2">&quot;element_#{Math.round(Math.random() * 1000000)}&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Pauses the presentation</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">pause: </span><span class="nf">() -&gt;</span>
    <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span><span class="p">].</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">pause</span><span class="p">()</span> <span class="k">if</span> <span class="nx">@currentChapterIndex</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Returns true if the presentation is paused</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">isPaused: </span><span class="nf">() -&gt;</span>
    <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span><span class="p">].</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">isPaused</span><span class="p">()</span> <span class="k">if</span> <span class="nx">@currentChapterIndex</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Starts/resume the presentation</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">play: </span><span class="nf">() -&gt;</span>
    <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span><span class="p">].</span><span class="nx">video</span><span class="p">.</span><span class="nx">_plugin</span><span class="p">.</span><span class="nx">play</span><span class="p">()</span> <span class="k">if</span> <span class="nx">@currentChapterIndex</span> <span class="o">isnt</span> <span class="o">-</span><span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Move the video to the next slide. Notice that some video plugins may refuse to react (due to buffering issues)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">next: </span><span class="nf">() -&gt;</span>
    <span class="k">if</span> <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span><span class="p">].</span><span class="nx">slides</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">@currentSlideIndex</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="nx">@changeChapter</span> <span class="nx">@currentChapterIndex</span><span class="p">,</span> <span class="nx">@currentSlideIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span>
      <span class="k">return</span> <span class="kc">true</span>
    <span class="k">if</span> <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">@currentChapterIndex</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="nx">@changeChapter</span> <span class="nx">@currentChapterIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">true</span>
      <span class="k">return</span> <span class="kc">true</span>
    <span class="k">return</span> <span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Move the video to the previous slide. Notice that some video plugins may refuse to react (due to buffering issues)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">previous: </span><span class="nf">() -&gt;</span>
    <span class="k">if</span> <span class="nx">@currentSlideIndex</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span>
      <span class="nx">@changeChapter</span> <span class="nx">@currentChapterIndex</span><span class="p">,</span> <span class="nx">@currentSlideIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span>
      <span class="k">return</span> <span class="kc">true</span>
    <span class="k">if</span> <span class="nx">@currentChapterIndex</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span>
      <span class="nx">@changeChapter</span> <span class="nx">@currentChapterIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">@presentation</span><span class="p">.</span><span class="nx">chapters</span><span class="p">[</span><span class="nx">@currentChapterIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">slides</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span>
      <span class="k">return</span> <span class="kc">true</span>
    <span class="k">return</span> <span class="kc">false</span>

<span class="nv">root = </span><span class="nx">exports</span> <span class="o">?</span> <span class="nb">window</span>
<span class="nv">root.presentz = </span><span class="p">{}</span> <span class="k">if</span> <span class="o">!</span><span class="nx">root</span><span class="p">.</span><span class="nx">presentz</span><span class="o">?</span>
<span class="nv">root.presentz.Presentz = </span><span class="nx">Presentz</span>
<span class="nv">root.Presentz = </span><span class="nx">Presentz</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 